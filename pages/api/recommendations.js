import { createClient } from '@supabase/supabase-js'; const supabase = createClient(process.env.NEXT_PUBLIC_SUPABASE_URL||'', process.env.SUPABASE_SERVICE_ROLE_KEY||''); export default async function handler(req,res){ if(req.method!=='POST') return res.status(405).end(); const { weakSkills } = req.body || {}; const { data: courses } = await supabase.from('courses').select('*').limit(50); const scored = (courses||[]).map(c=>({c,score:(c.tags||[]).filter(t=> (weakSkills||[]).includes(t)).length})).sort((a,b)=>b.score-a.score).slice(0,5).map(s=>s.c); res.json({ courses: scored, coach: null }); }
